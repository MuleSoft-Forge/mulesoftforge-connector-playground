{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "A2A TaskOrMessage",
    "description": "Structure to support either Task or Message object",
    "type": "object",
    "required": [],
    "properties": {
      "id": {
        "title": "Id",
        "type": "string",
        "description": "Task ID (for Task)"
      },
      "contextId": {
        "title": "contextId",
        "type": "string",
        "description": "Server-generated ID for contextual alignment across interactions"
      },
      "taskId": {
        "title": "taskId",
        "type": "string",
        "description": "Task ID (for Message)"
      },
      "status": {
        "$ref": "#/$defs/TaskStatus"
      },
      "artifacts": {
        "title": "Artifacts",
        "type": "array",
        "items": { "$ref": "#/$defs/Artifact" }
      },
      "history": {
        "title": "History",
        "type": "array",
        "items": { "$ref": "#/$defs/Message" }
      },
      "role": {
        "type": "string",
        "enum": ["user", "agent"],
        "description": "Sender: user (A2A Client) or agent (A2A Server)"
      },
      "parts": { 
        "$ref": "#/$defs/Parts"
      },
      "messageId": {
        "type": "string",
        "description": "Unique identifier for the message"
      },
      "kind": {
        "type": "string",
        "enum": ["task", "message"],
        "description":  "Type discriminator, literal value 'message'."
      },
      "referenceTaskIds": {
        "type": "array",
        "items": {
          "type": "string"
        },
        "description": "A list of other task IDs that this message references for additional context.",
        "title": "Reference task ids"
      },
      "metadata": {
        "title": "Metadata",
        "type": "object",
        "description": "Additional metadata",
        "additionalProperties": true
      }
    },
    "$defs": {
      "TaskStatus": {
        "title": "TaskStatus",
        "type": "object",
        "required": [
          "state"
        ],
        "properties": {
          "state": {
            "$ref": "#/$defs/TaskState"
          },
          "message": {
            "$ref": "#/$defs/Message",
            "default": null,
            "description": "Message containing task content"
          },
          "timestamp": {
            "format": "date-time",
            "title": "Timestamp",
            "type": "string"
          }
        }
      },
      "TaskState": {
        "description": "An enumeration.",
        "enum": [
          "submitted",
          "working",
          "input-required",
          "completed",
          "canceled",
          "failed",
          "rejected",
          "auth-required",
          "unknown"
        ],
        "title": "TaskState",
        "type": "string"
      },
      "Artifact": {
        "title": "Artifact",
        "type": "object",
        "required": [
          "artifactId",
          "parts"
        ],
        "properties": {
          "artifactId": {
            "type": "string",
            "description": "Unique identifier for the artifact",
            "title": "ArtifactId"
          },
          "name": {
            "type": "string",
            "title": "Name"
          },
          "description": {
            "type": "string",
            "title": "Description"
          },
          "parts": {
            "$ref": "#/$defs/Parts"
          },
          "metadata": {
            "additionalProperties": {},
            "type": "object",
            "title": "Metadata"
          },
          "extensions": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "The URIs of extensions that are present or contributed to this Artifact.",
            "title": "Extensions"
          }
        }
      },
      "Message": {
        "type": "object",
        "description": "Message containing task content",
        "required": ["role", "parts", "messageId", "kind"],
        "properties": {
          "role": {
            "type": "string",
            "enum": ["user", "agent"],
            "description": "Indicates the sender: \"user\" (from A2A Client) or \"agent\" (from A2A Server)."
          },
          "parts": {
            "$ref": "#/$defs/Parts"
          },
          "messageId": {
            "type": "string",
            "description": "Unique identifier for the message"
          },
          "taskId": {
            "type": "string",
            "description": "Unique identifier for the task"
          },
          "contextId": {
            "type": "string",
            "description": "Unique context identifier for the task"
          },
          "kind": {
            "type": "string",
            "const": "message",
            "description": "Type discriminator, literal value 'message'."
          },
          "referenceTaskIds": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "A list of other task IDs that this message references for additional context.",
            "title": "Reference task ids"
          },
          "metadata": {
            "type": "object",
            "description": "Additional metadata for the message",
            "additionalProperties": true
          },
          "extensions": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "The URIs of extensions that are present or contributed to this Message.",
            "title": "Extensions"
          }
        }
      },
      "Parts": {
        "title": "Parts",
        "type": "array",
        "items": {
          "$ref": "#/$defs/Part"
        }
      },
      "Part": {
        "title": "Part",
        "type": "object",
        "required": [],
        "properties": {
          "kind": {
            "type": "string",
            "enum": ["text", "file", "data"]
          },
          "text": {
            "type": "string"
          },
          "metadata": {
            "type": "object",
            "additionalProperties": true
          },
          "file": {
            "type": "object",
            "description": "Contains the file details and data/reference.",
            "required": [],
            "properties": {
              "bytes": {
                "type": "string",
                "contentEncoding": "base64",
                "description": "Base64 encoded bytes of the file"
              },
              "name": {
                "type": "string"
              },
              "mimeType": {
                "type": "string"
              },
              "uri": {
                "type": "string"
              }
            }
          },
          "data": {
            "type": "object",
            "additionalProperties": true
          }
        }
      }
    }
}
  